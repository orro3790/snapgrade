import { initializeApp, cert, getApps } from 'firebase-admin/app';
import { getAuth } from 'firebase-admin/auth';
import { getFirestore } from 'firebase-admin/firestore';
const base64EncodedServiceAccount = "ewogICJ0eXBlIjogInNlcnZpY2VfYWNjb3VudCIsCiAgInByb2plY3RfaWQiOiAic25hcGdyYWRlLTgxOGY1IiwKICAicHJpdmF0ZV9rZXlfaWQiOiAiMjdlMDMyMzEwNjQ4M2UxN2U3ODA0ODJlMzE2NjRhZmU3YzdjYWIxNiIsCiAgInByaXZhdGVfa2V5IjogIi0tLS0tQkVHSU4gUFJJVkFURSBLRVktLS0tLVxuTUlJRXZnSUJBREFOQmdrcWhraUc5dzBCQVFFRkFBU0NCS2d3Z2dTa0FnRUFBb0lCQVFDRjRYSkFYWHdBNFVlOVxuUmZaVWpLV2xER0lJaldtUWFuV0JzTWVFa2R3bmZOa3VjR2UvbG1tR1kzRURvL2lnekdaakZtMGNZUFkzKzRVS1xucHVIR0lCelVGdkZGY3dNQ2NkN09MTERmeGhCb29CMUlGQXBvY1dmYStmNWpBQktFczdXQzQ1RGhydWxxUzZKVlxuZUY5blFSTEdnMlI0eElOeFJTcGMvNUlRUUNNdElSZUQydDhiRG9rQUdVdzU5bDRtTkFoRUtvK2E3cFpqTHQ3elxubURzRHpZTkdxaHpla0JXNFptUStwdUdxNGExSnNuUElCd1NRRGFOaldWVG5xVExDcGFZSXpCeU4vb0UxbEpjdVxuQUlYWXQvaFFjQnI3d2tDN3hLQmpsTERzRUxGZVFqYjdVME55dXh5dzRmcXFnSTN2OC9kS0tUS1VIVWN6ZkhOVlxuaTlPSW0wbWJBZ01CQUFFQ2dnRUFLQUovYytmY01xRWdvTnBqS3RKYmdHOHFidmJmNk9ZLzFyRy9kb2xtbXpCdVxuOFRkcmNmQ2YrYWNITTdqUmlUQjhtcmt0ZzNFZ3RBdEpMNjAreE1oOUJROFVMSmFaL0NXT21kdjJRZkc5bnA3WFxuRVY3WDIyMmt4V2EzbE51RkxUNU5qTis0UVJIV05NdUVxSGxRUFpuUFpCOEpMQ1JDU2R3TE5INjJKb0FjWXhSVlxuZWwveWg0UGRYczI5NkxHSTJpWGRpMzQrbHdnSHdhWXBmcXdRZ21oakVwa3liNGgxeFRUWjJnSjhIdGFuZjU5dFxuMldNVDk0SmxRSkVKYW14QzhCbFI4WHdJR1FPUFNQektPdGdqN29qM2dZUUd3RllWNHBaTkY3ZWRnampIeUhROFxuWG8wUVlodUlkSVllaUg2ckdVOEhIWTJxLzdBRlFWRXlBb2I1bjA0WmtRS0JnUUM3ckdzUlpmTUdxdGZXRnZ2YVxuYzI5QlB0SlNuMmVrVCtCVXpQMEtSV0hldkpMUGpSQ09LeTdCUHM0WW1pb3ZENDFqaXpCeURsY2tUSjhEWXY5YlxuUDl1Ri95U2s5R2xOakxHOWtUaW5qYzhTRlpkNWR0STAvYmx6b2szT1Z0UEptZHdFZTZPM1p0amp4NlpwWHFISlxuL2JkaHNUQUFCU1pRejh0WWJUS3N2L1YveXdLQmdRQzJuMnAxZEFrUG9JL3NXM0JreWpCWkxuU1UxQkl4VDJBS1xuS2F1cDlRYUd5L3BXSTJEOTdyc3N4bVZWeE8yYUovQWV3Vm9TN1ZWNWJFeVdxRURQL3ppWmpCdktZSmQzTjB5UVxuaWErVU9WNjA3dWRseGlhSGJHYUJYb0t3SWFYeFoyWkkxdmV0L1VJcGJ6T3NDQWxBU2pwdmFPMTZqN1dnMndsSVxubTJuRTZXdURjUUtCZ1FDdTZ6NER3a3pvQ3ZZT3dlOU5wVWV0dlRyVTdXUHhIczNNM0I2QW96aGNITkNOQ0VMRVxuNzNTdGdyY2U4Um1lTVZXcjBRQi9YZVJVbmVHYmkzckw5dEhKcTR2Zy96amlvZDdMKy8yZEZheEpnN3hoNXFCM1xuNllBZlNjaFJLRlpQVWN0aWxrWjZXeTZONXZpd3Z4WDJxVFp4cEc5RHBZa1h5d1VSVHYzclN5TXJUd0tCZ1FDS1xuM1ltc0trSEJta3dXWkNtQTJxWU5DbUFuMDJMS0VCdHRYdVpqNUNmRVZGTFZNUzNOcWJ5MmZWNE03Q1BvZHJvR1xuQ095Zk84MGsrWTc3ZUpGZ0dDaEh5ZHhQOVViM3Boc1lSVG8zc2JBc1VRV3Z4QThFSncrRERBVEFQYlhiYk03QVxuVUlZaHpWU0VBVVQvYVZUdmlBSUxPWFJySDkveW90dmFWQ01IVXA4b1lRS0JnQVJVcU1kYWY4ZDU4YktxVDlUaVxuUThUTU9vQzRjbEhwMEpLNXl3dkduSFQ0d0M3NWx5RjRaUlBIdGxWSXBqaEFlZjBDckthNkpqSFZPRGlTNXBIaVxuYzNrV3pDaUFMNndPNzlLT1lYMWNodSs1TVNCMzFYeHY3blJTUEJsWjA2NGNNaXlVWTVpaDNhNlNmaDh6dmxPYlxuRFZKZ01JNEFkVU1yUkxKNmthWHd2dW1SXG4tLS0tLUVORCBQUklWQVRFIEtFWS0tLS0tXG4iLAogICJjbGllbnRfZW1haWwiOiAiZmlyZWJhc2UtYWRtaW5zZGstZmJzdmNAc25hcGdyYWRlLTgxOGY1LmlhbS5nc2VydmljZWFjY291bnQuY29tIiwKICAiY2xpZW50X2lkIjogIjEwMDQyNTgwNzA4MTA5MTA5ODE1MCIsCiAgImF1dGhfdXJpIjogImh0dHBzOi8vYWNjb3VudHMuZ29vZ2xlLmNvbS9vL29hdXRoMi9hdXRoIiwKICAidG9rZW5fdXJpIjogImh0dHBzOi8vb2F1dGgyLmdvb2dsZWFwaXMuY29tL3Rva2VuIiwKICAiYXV0aF9wcm92aWRlcl94NTA5X2NlcnRfdXJsIjogImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL29hdXRoMi92MS9jZXJ0cyIsCiAgImNsaWVudF94NTA5X2NlcnRfdXJsIjogImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL3JvYm90L3YxL21ldGFkYXRhL3g1MDkvZmlyZWJhc2UtYWRtaW5zZGstZmJzdmMlNDBzbmFwZ3JhZGUtODE4ZjUuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iLAogICJ1bml2ZXJzZV9kb21haW4iOiAiZ29vZ2xlYXBpcy5jb20iCn0K";
function initializeAdminApp() {
    if (getApps().length > 0) {
        return getApps()[0];
    }
    if (!base64EncodedServiceAccount) {
        throw new Error('Missing Firebase base64 encoded service account');
    }
    try {
        const decodedServiceAccount = Buffer.from(base64EncodedServiceAccount, 'base64').toString('utf-8');
        const credentials = JSON.parse(decodedServiceAccount);
        return initializeApp({
            credential: cert(credentials)
        });
    }
    catch (error) {
        console.error('Firebase admin initialization error:', error);
        throw error;
    }
}
const firebaseAdminApp = initializeAdminApp();
export const adminAuth = getAuth(firebaseAdminApp);
export const adminDb = getFirestore(firebaseAdminApp);
